webpackJsonp([14],{QdSr:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});e("XmAh");var a=e("il3B"),r=(e("eqfM"),e("/QYm")),i=(e("Xrj1"),e("1nur")),n=e("nBqZ"),o=(e("VTEy"),e("mtWM"),e("7+uW"));o.a.use(i.a),o.a.use(r.a);var u=null,p={name:"Upgrading",data:function(){return{frequency:0,toast:null,percent:0,progressS:!0,progressTip:"Upgrading software...",progresSteps:null,nowStatus:null,progressColor:"#861f41",stepsFail:!1}},mounted:function(){console.log(this.$route.query);if(this.toast=this.utils.ToastMsg(3,0,"Waiting for changes to be applied..."),this.nowStatus=this.$route.query.steps,this.progresSteps=this.$route.query.steps,"null"!=this.nowStatus&&null!=this.nowStatus){var t={status:this.nowStatus,steps:this.progresSteps};this.statusHandle(t)}else this.no4Getstatus()},methods:{no4Getstatus:function(){var t=this;u=setInterval(function(){Object(n.b)("GetUpgradeStatus",{status:0},0).then(function(s){s.result?t.statusHandle(s.result):s.error&&t.utils.ToastMsg(0,2e3,s.error.message)}).catch(function(s){console.log(s.message),t.frequency++,t.frequency>3&&(t.frequency=0,t.utils.DialogErr("Please wait patiently while the device is upgrading and restarting!","Tips"))})},1e4)},statusHandle:function(t){if("1"==t.status){this.StateResponse(1),this.toast.clear();var s="Now the status isï¼š"+t.status+"--Upgrade Complete...";this.progresSteps=s,clearInterval(u),this.PromptSuccess()}else"0"==t.status?(clearInterval(u),this.StateResponse(1),this.toast.clear(),this.progresSteps=t.steps,this.stepsFail=!0,this.Promptfail()):"2"==t.status?this.progresSteps=t.steps:"3"==t.status?(this.toast.clear(),this.progresSteps=t.steps,this.progressS=!1,clearInterval(u)):"4"==t.status?(this.StateResponse(1),clearInterval(u),this.progresSteps=t.steps,this.timerOut(18e4,this.no4Getstatus)):"5"==t.status?(clearInterval(u),this.StateResponse(1),this.progresSteps=t.steps,this.timerOut(9e4,this.no4Getstatus)):"6"==t.status&&(clearInterval(u),this.StateResponse(1),this.progresSteps=t.steps,this.timerOut(3e5,this.no4Getstatus))},StateResponse:function(){Object(n.b)("GetUpgradeStatus",{status:1}).then(function(t){}).catch(function(t){})},PromptSuccess:function(){var t=this;a.a.alert({title:"Success message",message:"Upgrade successfully"}).then(function(){t.$router.push({path:"/Home"})})},Promptfail:function(){var t=this;a.a.alert({title:"Fail message",message:"Upgrade fail"}).then(function(){t.$router.push({path:"/SoftwareUpgrade"})})},timerOut:function(t,s){clearInterval(u),setTimeout(function(){s()},t)}}},l={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"Upgrading"},[e("div",{staticClass:"Upgrade-title"},[t._v("\n    "+t._s(t.progressTip)+"\n  ")]),t._v(" "),e("div",{staticClass:"Upgrade-steps",class:t.stepsFail?"steps-fail":""},[t._v("\n    "+t._s(t.progresSteps)+"\n  ")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.progressS,expression:"progressS"}],staticClass:"progress-c"},[e("van-progress",{attrs:{percentage:t.percent,"stroke-width":"14",color:t.progressColor}})],1)])},staticRenderFns:[]};var c=e("VU/8")(p,l,!1,function(t){e("U0Mw")},"data-v-4a1086cd",null);s.default=c.exports},U0Mw:function(t,s){}});