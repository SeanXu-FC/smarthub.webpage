webpackJsonp([12],{QdSr:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});e("XmAh");var r=e("il3B"),a=e("mvHQ"),n=e.n(a),i=(e("eqfM"),e("/QYm")),o=(e("Xrj1"),e("1nur")),u=e("nBqZ"),p=(e("VTEy"),e("mtWM"),e("7+uW"));p.a.use(o.a),p.a.use(i.a);var l=null,c=null,h={name:"Upgrading",data:function(){return{frequency:0,toast:null,percent:0,progressS:!0,progressTip:"Upgrading software...",progresSteps:null,nowStatus:null,progressColor:"#861f41",stepsFail:!1}},mounted:function(){console.log(this.$route.query);if(this.toast=this.utils.ToastMsg(3,0,"Waiting for changes to be applied..."),this.nowStatus=this.$route.query.status,this.progresSteps=this.$route.query.steps,console.log(this.nowStatus,this.progresSteps),"null"!=this.nowStatus&&null!=this.nowStatus){var t={status:this.nowStatus,steps:this.progresSteps};console.log(t),this.statusHandle(t)}else this.no4Getstatus();this.percentTimer()},methods:{percentTimer:function(t){var s=this;clearInterval(c),c=setInterval(function(){s.percent<80?s.percent++:clearInterval(c)},625)},no4Getstatus:function(){var t=this;l=setInterval(function(){Object(u.b)("GetUpgradeStatus",{status:0},0).then(function(s){s.result?t.statusHandle(s.result):s.error&&t.utils.ToastMsg(0,2e3,s.error.message)}).catch(function(s){console.log(n()(s)),t.frequency++,t.frequency>3&&(t.frequency=0,t.utils.DialogErr("Please wait patiently while the device is upgrading and restarting!","Tips"))})},1e4)},statusHandle:function(t){if("1"==t.status){this.percent=100,this.StateResponse(1),this.toast.clear();var s="Now the status isï¼š"+t.status+"--Upgrade Complete...";this.progresSteps=s,clearInterval(l),this.PromptSuccess(t.steps)}else"0"==t.status?(this.percent=80,clearInterval(l),this.StateResponse(1),this.toast.clear(),this.progresSteps=t.steps,this.stepsFail=!0,this.Promptfail(t.steps)):"2"==t.status?(this.progresSteps=t.steps,clearInterval(l),this.no4Getstatus()):"3"==t.status?(this.percent=80,this.toast.clear(),this.progresSteps=t.steps,this.progressS=!1,clearInterval(l)):"4"==t.status?(this.StateResponse(1),clearInterval(l),this.progresSteps=t.steps,this.timerOut(18e4,this.no4Getstatus)):"5"==t.status?(clearInterval(l),this.StateResponse(1),this.progresSteps=t.steps,this.timerOut(9e4,this.no4Getstatus)):"6"==t.status&&(clearInterval(l),this.StateResponse(1),this.progresSteps=t.steps,this.timerOut(3e5,this.no4Getstatus))},StateResponse:function(){Object(u.b)("GetUpgradeStatus",{status:1}).then(function(t){}).catch(function(t){})},PromptSuccess:function(t){var s=this;r.a.alert({title:"Success message",message:t}).then(function(){s.$router.push({path:"/Home"})})},Promptfail:function(t){var s=this;r.a.alert({title:"Fail message",message:t}).then(function(){s.$router.push({path:"/SoftwareUpgrade"})})},timerOut:function(t,s){clearInterval(l),setTimeout(function(){s()},t)}}},g={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"Upgrading"},[e("div",{staticClass:"Upgrade-title"},[t._v("\n    "+t._s(t.progressTip)+"\n  ")]),t._v(" "),e("div",{staticClass:"Upgrade-steps",class:t.stepsFail?"steps-fail":""},[t._v("\n    "+t._s(t.progresSteps)+"\n  ")]),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.progressS,expression:"progressS"}],staticClass:"progress-c"},[e("van-progress",{attrs:{percentage:t.percent,"stroke-width":"14",color:t.progressColor}})],1)])},staticRenderFns:[]};var f=e("VU/8")(h,g,!1,function(t){e("ygGh")},"data-v-c93d5182",null);s.default=f.exports},ygGh:function(t,s){}});